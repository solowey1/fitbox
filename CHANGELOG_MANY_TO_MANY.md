# Changelog - –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ Many-to-Many —Å—Ç—Ä—É–∫—Ç—É—Ä—É

## –í–µ—Ä—Å–∏—è 2.0.0 - Many-to-Many –¥–ª—è –ø—Ä–æ–≥—Ä–∞–º–º –ø–∏—Ç–∞–Ω–∏—è

### üéØ –û—Å–Ω–æ–≤–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

#### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

**–î–æ–±–∞–≤–ª–µ–Ω–æ:**
- –¢–∞–±–ª–∏—Ü–∞ `city_nutrition_programs` - —Å–≤—è–∑—å –≥–æ—Ä–æ–¥–æ–≤ –∏ –ø—Ä–æ–≥—Ä–∞–º–º –ø–∏—Ç–∞–Ω–∏—è (many-to-many)
- –ò–Ω–¥–µ–∫—Å—ã –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –ø–æ —Å–≤—è–∑—è–º
- –¢—Ä–∏–≥–≥–µ—Ä –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è `updated_at`

**–ò–∑–º–µ–Ω–µ–Ω–æ:**
- –¢–∞–±–ª–∏—Ü–∞ `nutrition_programs` –±–æ–ª—å—à–µ –ù–ï —Å–æ–¥–µ—Ä–∂–∏—Ç `city_id`
- –û–¥–Ω–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∞ —Ç–µ–ø–µ—Ä—å —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–º —ç–∫–∑–µ–º–ø–ª—è—Ä–µ

**–£–¥–∞–ª–µ–Ω–æ:**
- –ü–æ–ª–µ `city_id` –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `nutrition_programs` (–ø–æ—Å–ª–µ –º–∏–≥—Ä–∞—Ü–∏–∏)
- –ò–Ω–¥–µ–∫—Å `idx_nutrition_programs_city_id`

#### API Endpoints

**–ò–∑–º–µ–Ω–µ–Ω–æ:**
- `GET /api/programs` - —Ç–µ–ø–µ—Ä—å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `city_ids` –∏ `city_names` –≤–º–µ—Å—Ç–æ `city_id` –∏ `city_name`
- `GET /api/programs/:id` - —Ñ–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞ –∏–∑–º–µ–Ω–µ–Ω (–º–∞—Å—Å–∏–≤—ã –≥–æ—Ä–æ–¥–æ–≤)
- `POST /api/programs` - –ø—Ä–∏–Ω–∏–º–∞–µ—Ç `city_ids` (–º–∞—Å—Å–∏–≤) –≤–º–µ—Å—Ç–æ `city_id`
- `PUT /api/programs/:id` - –ø—Ä–∏–Ω–∏–º–∞–µ—Ç `city_ids` (–º–∞—Å—Å–∏–≤) –≤–º–µ—Å—Ç–æ `city_id`

**–î–æ–±–∞–≤–ª–µ–Ω–æ:**
- `POST /api/programs/:programId/cities/:cityId` - –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É –≤ –≥–æ—Ä–æ–¥
- `DELETE /api/programs/:programId/cities/:cityId` - —É–¥–∞–ª–∏—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É –∏–∑ –≥–æ—Ä–æ–¥–∞

#### –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã

**–ò–∑–º–µ–Ω–µ–Ω–æ:**
- `nutritionProgramsController.js` - –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–ø–∏—Å–∞–Ω –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å many-to-many

**–î–æ–±–∞–≤–ª–µ–Ω–æ:**
- `addProgramToCity()` - –º–µ—Ç–æ–¥ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã –≤ –≥–æ—Ä–æ–¥
- `removeProgramFromCity()` - –º–µ—Ç–æ–¥ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã –∏–∑ –≥–æ—Ä–æ–¥–∞

#### –ú–∏–≥—Ä–∞—Ü–∏–∏

**–î–æ–±–∞–≤–ª–µ–Ω–æ:**
- `003_convert_to_many_to_many.sql` - —Å–∫—Ä–∏–ø—Ç –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö

**–ò–∑–º–µ–Ω–µ–Ω–æ:**
- `001_initial_schema.sql` - –æ–±–Ω–æ–≤–ª–µ–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü
- `002_seed_data.sql` - —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –Ω–æ–≤—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É

### üìä –ü—Ä–∏–º–µ—Ä—ã –∏–∑–º–µ–Ω–µ–Ω–∏–π

#### –ë—ã–ª–æ (v1.0.0):
```json
{
  "id": 1,
  "title": "–ë–∞–ª–∞–Ω—Å",
  "emoji": "‚öñÔ∏è",
  "city_id": 1,
  "city_name": "–£–ª—å—è–Ω–æ–≤—Å–∫"
}
```

#### –°—Ç–∞–ª–æ (v2.0.0):
```json
{
  "id": 1,
  "title": "–ë–∞–ª–∞–Ω—Å",
  "emoji": "‚öñÔ∏è",
  "city_ids": [1, 2, 3, 4, 5],
  "city_names": ["–£–ª—å—è–Ω–æ–≤—Å–∫", "–ö–∞–∑–∞–Ω—å", "–°–∞–º–∞—Ä–∞", "–¢–æ–ª—å—è—Ç—Ç–∏", "–î–º–∏—Ç—Ä–æ–≤–≥—Ä–∞–¥"]
}
```

### üîÑ –ú–∏–≥—Ä–∞—Ü–∏—è

–î–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤:

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é
npm run migrate

# –ò–ª–∏ –≤—Ä—É—á–Ω—É—é
psql -U postgres -d fitbox -f migrations/003_convert_to_many_to_many.sql
```

### ‚ö†Ô∏è Breaking Changes

1. **–§–æ—Ä–º–∞—Ç API –∏–∑–º–µ–Ω–µ–Ω** - —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å
2. **–ü–æ–ª–µ `city_id` —É–¥–∞–ª–µ–Ω–æ** - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `city_ids`
3. **–¢—Ä–µ–±—É–µ—Ç—Å—è –º–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö** - –¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ë–î

### üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- [MIGRATION_GUIDE.md](MIGRATION_GUIDE.md) - –ø–æ–¥—Ä–æ–±–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –º–∏–≥—Ä–∞—Ü–∏–∏
- [API_EXAMPLES.md](API_EXAMPLES.md) - –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤

### ‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

1. **–ù–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è** - –∫–∞–∂–¥–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ –æ–¥–Ω–æ–º —ç–∫–∑–µ–º–ø–ª—è—Ä–µ
2. **–õ–µ–≥–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ** - –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∫–æ –≤—Å–µ–º –≥–æ—Ä–æ–¥–∞–º —Å—Ä–∞–∑—É
3. **–ì–∏–±–∫–æ—Å—Ç—å** - –ø—Ä–æ–≥—Ä–∞–º–º—ã –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å/—É–¥–∞–ª—è—Ç—å –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –≥–æ—Ä–æ–¥–∞—Ö
4. **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - –º–µ–Ω—å—à–µ –¥–∞–Ω–Ω—ã—Ö, –±—ã—Å—Ç—Ä–µ–µ –∑–∞–ø—Ä–æ—Å—ã

### üêõ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

- –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º –ø–∏—Ç–∞–Ω–∏—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –≥–æ—Ä–æ–¥–∞
- –°–ª–æ–∂–Ω–æ—Å—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π –º–µ–∂–¥—É –≥–æ—Ä–æ–¥–∞–º–∏
- –ò–∑–±—ã—Ç–æ—á–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ë–î

### üìù TODO –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

- [ ] –û–±–Ω–æ–≤–∏—Ç—å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –Ω–æ–≤—ã–º —Ñ–æ—Ä–º–∞—Ç–æ–º API
- [ ] –ó–∞–ø—É—Å—Ç–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –Ω–∞ production –ë–î
- [ ] –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –ø—Ä–æ–µ–∫—Ç–∞
- [ ] –û–±–Ω–æ–≤–∏—Ç—å unit-—Ç–µ—Å—Ç—ã
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è–º–∏

---

**–î–∞—Ç–∞ —Ä–µ–ª–∏–∑–∞:** 2026-01-14
**–ê–≤—Ç–æ—Ä:** Claude Sonnet 4.5
