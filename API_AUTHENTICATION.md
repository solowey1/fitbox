# API –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

## –û–±–∑–æ—Ä

API –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –¥–≤—É—Ö—É—Ä–æ–≤–Ω–µ–≤—É—é —Å–∏—Å—Ç–µ–º—É –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:
- **–ü—É–±–ª–∏—á–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (GET)** - –¥–æ—Å—Ç—É–ø–Ω—ã –±–µ–∑ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- **–ú—É—Ç–∏—Ä—É—é—â–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (POST, PUT, PATCH, DELETE)** - —Ç—Ä–µ–±—É—é—Ç API –∫–ª—é—á

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ API –∫–ª—é—á–∞

### 1. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è API –∫–ª—é—á–∞

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏ —Å—Ç–æ–π–∫–∏–π –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–ª—é—á–∞:

```bash
node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
```

### 2. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–ª—é—á–∞ –≤ .env

```env
API_KEY=–≤–∞—à_—Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π_–∫–ª—é—á_–∑–¥–µ—Å—å
```

**–í–∞–∂–Ω–æ:**
- –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –∫–æ–º–º–∏—Ç—å—Ç–µ —Ñ–∞–π–ª `.env` –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–∞–∑–Ω—ã–µ –∫–ª—é—á–∏ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
- –•—Ä–∞–Ω–∏—Ç–µ –∫–ª—é—á–∏ –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–º –º–µ—Å—Ç–µ (password manager, secrets manager)

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ API –∫–ª—é—á–∞

### –°–ø–æ—Å–æ–± 1: –ó–∞–≥–æ–ª–æ–≤–æ–∫ X-API-Key (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
curl -X POST https://api.fitbox.su/api/programs \
  -H "X-API-Key: your-api-key" \
  -H "Content-Type: application/json" \
  -d '{"title":"–ù–æ–≤–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞"}'
```

### –°–ø–æ—Å–æ–± 2: Authorization –∑–∞–≥–æ–ª–æ–≤–æ–∫

```bash
curl -X POST https://api.fitbox.su/api/programs \
  -H "Authorization: Bearer your-api-key" \
  -H "Content-Type: application/json" \
  -d '{"title":"–ù–æ–≤–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞"}'
```

### –°–ø–æ—Å–æ–± 3: Query –ø–∞—Ä–∞–º–µ—Ç—Ä (–ù–ï —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
curl -X POST "https://api.fitbox.su/api/programs?api_key=your-api-key" \
  -H "Content-Type: application/json" \
  -d '{"title":"–ù–æ–≤–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞"}'
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** Query –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ –∏—Å—Ç–æ—Ä–∏–∏ –±—Ä–∞—É–∑–µ—Ä–∞ –∏ —Å–µ—Ä–≤–µ—Ä–Ω—ã—Ö –ª–æ–≥–∞—Ö, –ø–æ—ç—Ç–æ–º—É —ç—Ç–æ—Ç —Å–ø–æ—Å–æ–± –º–µ–Ω–µ–µ –±–µ–∑–æ–ø–∞—Å–µ–Ω.

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### JavaScript/TypeScript (Fetch API)

```javascript
const API_KEY = process.env.API_KEY; // –•—Ä–∞–Ω–∏—Ç–µ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è!

// –ü—É–±–ª–∏—á–Ω—ã–π –∑–∞–ø—Ä–æ—Å (–±–µ–∑ –∫–ª—é—á–∞)
const programs = await fetch('https://api.fitbox.su/api/programs');
const data = await programs.json();

// –ó–∞—â–∏—â–µ–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å (—Å –∫–ª—é—á–æ–º)
const response = await fetch('https://api.fitbox.su/api/programs', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
    'X-API-Key': API_KEY
  },
  body: JSON.stringify({
    title: '–ù–æ–≤–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞',
    emoji: 'üèÉ',
    sort: 1
  })
});
```

### Node.js (Axios)

```javascript
const axios = require('axios');

const api = axios.create({
  baseURL: 'https://api.fitbox.su/api',
  headers: {
    'X-API-Key': process.env.API_KEY
  }
});

// –ó–∞—â–∏—â–µ–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å
const response = await api.post('/programs', {
  title: '–ù–æ–≤–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞',
  emoji: 'üèÉ'
});
```

### Python (requests)

```python
import os
import requests

API_KEY = os.getenv('API_KEY')

# –ó–∞—â–∏—â–µ–Ω–Ω—ã–π –∑–∞–ø—Ä–æ—Å
response = requests.post(
    'https://api.fitbox.su/api/programs',
    headers={'X-API-Key': API_KEY},
    json={'title': '–ù–æ–≤–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞', 'emoji': 'üèÉ'}
)
```

## –ú–∞—Ç—Ä–∏—Ü–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞–º

| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–∏–Ω—Ç | –¢—Ä–µ–±—É–µ—Ç—Å—è –∫–ª—é—á | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|----------|----------------|----------|
| GET | `/api/cities` | ‚ùå | –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≥–æ—Ä–æ–¥–æ–≤ |
| GET | `/api/cities/:id` | ‚ùå | –ü–æ–ª—É—á–∏—Ç—å –≥–æ—Ä–æ–¥ –ø–æ ID |
| POST | `/api/cities` | ‚úÖ | –°–æ–∑–¥–∞—Ç—å –≥–æ—Ä–æ–¥ |
| PUT | `/api/cities/:id` | ‚úÖ | –û–±–Ω–æ–≤–∏—Ç—å –≥–æ—Ä–æ–¥ |
| DELETE | `/api/cities/:id` | ‚úÖ | –£–¥–∞–ª–∏—Ç—å –≥–æ—Ä–æ–¥ |
| GET | `/api/programs` | ‚ùå | –ü–æ–ª—É—á–∏—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—ã –ø–∏—Ç–∞–Ω–∏—è |
| GET | `/api/programs/:id` | ‚ùå | –ü–æ–ª—É—á–∏—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É –ø–æ ID |
| GET | `/api/programs/:id/prices` | ‚ùå | –ü–æ–ª—É—á–∏—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É —Å —Ü–µ–Ω–∞–º–∏ |
| POST | `/api/programs` | ‚úÖ | –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É |
| PUT | `/api/programs/:id` | ‚úÖ | –û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É |
| DELETE | `/api/programs/:id` | ‚úÖ | –£–¥–∞–ª–∏—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É |
| POST | `/api/programs/:id/cities/:cityId` | ‚úÖ | –ü—Ä–∏–≤—è–∑–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É –∫ –≥–æ—Ä–æ–¥—É |
| DELETE | `/api/programs/:id/cities/:cityId` | ‚úÖ | –û—Ç–≤—è–∑–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É –æ—Ç –≥–æ—Ä–æ–¥–∞ |
| GET | `/api/dishes` | ‚ùå | –ü–æ–ª—É—á–∏—Ç—å –±–ª—é–¥–∞ |
| GET | `/api/dishes/:id` | ‚ùå | –ü–æ–ª—É—á–∏—Ç—å –±–ª—é–¥–æ –ø–æ ID |
| GET | `/api/dishes/:id/ingredients` | ‚ùå | –ü–æ–ª—É—á–∏—Ç—å –±–ª—é–¥–æ —Å –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–∞–º–∏ |
| POST | `/api/dishes` | ‚úÖ | –°–æ–∑–¥–∞—Ç—å –±–ª—é–¥–æ |
| PUT | `/api/dishes/:id` | ‚úÖ | –û–±–Ω–æ–≤–∏—Ç—å –±–ª—é–¥–æ |
| DELETE | `/api/dishes/:id` | ‚úÖ | –£–¥–∞–ª–∏—Ç—å –±–ª—é–¥–æ |
| GET | `/api/orders` | ‚ùå | –ü–æ–ª—É—á–∏—Ç—å –∑–∞–∫–∞–∑—ã |
| GET | `/api/orders/:id` | ‚ùå | –ü–æ–ª—É—á–∏—Ç—å –∑–∞–∫–∞–∑ –ø–æ ID |
| POST | `/api/orders` | ‚ùå | –°–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑ (–ø—É–±–ª–∏—á–Ω–æ) |
| PUT | `/api/orders/:id` | ‚úÖ | –û–±–Ω–æ–≤–∏—Ç—å –∑–∞–∫–∞–∑ |
| DELETE | `/api/orders/:id` | ‚úÖ | –£–¥–∞–ª–∏—Ç—å –∑–∞–∫–∞–∑ |

## –ö–æ–¥—ã –æ—à–∏–±–æ–∫

### 401 Unauthorized
```json
{
  "error": "Unauthorized",
  "message": "API key is required for this operation"
}
```

**–ü—Ä–∏—á–∏–Ω–∞:** API –∫–ª—é—á –Ω–µ –±—ã–ª –ø–µ—Ä–µ–¥–∞–Ω –≤ –∑–∞–ø—Ä–æ—Å–µ

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤—å—Ç–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫ `X-API-Key` —Å –≤–∞—à–∏–º –∫–ª—é—á–æ–º

### 403 Forbidden
```json
{
  "error": "Forbidden",
  "message": "Invalid API key"
}
```

**–ü—Ä–∏—á–∏–Ω–∞:** –ü–µ—Ä–µ–¥–∞–Ω –Ω–µ–≤–µ—Ä–Ω—ã–π API –∫–ª—é—á

**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å API –∫–ª—é—á–∞ –≤ `.env` —Ñ–∞–π–ª–µ

### 500 Internal Server Error
```json
{
  "error": "Server configuration error",
  "message": "API key is not configured"
}
```

**–ü—Ä–∏—á–∏–Ω–∞:** API –∫–ª—é—á –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

**–†–µ—à–µ–Ω–∏–µ:** –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –¥–æ–ª–∂–µ–Ω –¥–æ–±–∞–≤–∏—Ç—å `API_KEY` –≤ `.env` —Ñ–∞–π–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

## Best Practices

1. **–•—Ä–∞–Ω–∏—Ç–µ –∫–ª—é—á–∏ –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏**
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
   - –ù–µ –∫–æ–º–º–∏—Ç—å—Ç–µ `.env` —Ñ–∞–π–ª—ã
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ secrets managers –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

2. **–†–æ—Ç–∞—Ü–∏—è –∫–ª—é—á–µ–π**
   - –†–µ–≥—É–ª—è—Ä–Ω–æ –º–µ–Ω—è–π—Ç–µ API –∫–ª—é—á–∏ (—Ä–∞–∑ –≤ 3-6 –º–µ—Å—è—Ü–µ–≤)
   - –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ –º–µ–Ω—è–π—Ç–µ –∫–ª—é—á–∏ –ø—Ä–∏ –∫–æ–º–ø—Ä–æ–º–µ—Ç–∞—Ü–∏–∏

3. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ HTTPS**
   - –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ HTTPS –¥–ª—è –∑–∞—â–∏—Ç—ã –∫–ª—é—á–µ–π –ø—Ä–∏ –ø–µ—Ä–µ–¥–∞—á–µ
   - –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –ø–µ—Ä–µ–¥–∞–≤–∞–π—Ç–µ –∫–ª—é—á–∏ –ø–æ HTTP

4. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**
   - –ù–µ –ª–æ–≥–∏—Ä—É–π—Ç–µ API –∫–ª—é—á–∏
   - –õ–æ–≥–∏—Ä—É–π—Ç–µ –ø–æ–ø—ã—Ç–∫–∏ –Ω–µ—Å–∞–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞

5. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**
   - –û—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
   - –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–ª–µ—Ä—Ç—ã –Ω–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –Ω–µ—É–¥–∞—á–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ

```bash
# 1. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ API –∫–ª—é—á –≤ .env
echo "API_KEY=test-key-12345" >> .env

# 2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä
npm start

# 3. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –ø—É–±–ª–∏—á–Ω—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç (–±–µ–∑ –∫–ª—é—á–∞)
curl http://localhost:3000/api/programs

# 4. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –∑–∞—â–∏—â–µ–Ω–Ω—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç (–±–µ–∑ –∫–ª—é—á–∞ - –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ—à–∏–±–∫–∞)
curl -X POST http://localhost:3000/api/programs \
  -H "Content-Type: application/json" \
  -d '{"title":"Test"}'

# 5. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –∑–∞—â–∏—â–µ–Ω–Ω—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç (—Å –∫–ª—é—á–æ–º - –¥–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å)
curl -X POST http://localhost:3000/api/programs \
  -H "Content-Type: application/json" \
  -H "X-API-Key: test-key-12345" \
  -d '{"title":"Test"}'
```

## FAQ

**Q: –ù—É–∂–µ–Ω –ª–∏ API –∫–ª—é—á –¥–ª—è —á—Ç–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö (GET –∑–∞–ø—Ä–æ—Å—ã)?**
A: –ù–µ—Ç, –≤—Å–µ GET –∑–∞–ø—Ä–æ—Å—ã –¥–æ—Å—Ç—É–ø–Ω—ã –ø—É–±–ª–∏—á–Ω–æ –±–µ–∑ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.

**Q: –ö–∞–∫ –∑–∞—â–∏—Ç–∏—Ç—å POST /api/orders –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–∫–∞–∑–æ–≤ –∫–ª–∏–µ–Ω—Ç–∞–º–∏?**
A: –°–µ–π—á–∞—Å —ç—Ç–æ—Ç —ç–Ω–¥–ø–æ–∏–Ω—Ç –ø—É–±–ª–∏—á–Ω—ã–π. –ï—Å–ª–∏ –Ω—É–∂–Ω–∞ –∑–∞—â–∏—Ç–∞, –¥–æ–±–∞–≤—å—Ç–µ `authMiddleware` –≤ —Ä–æ—É—Ç –∏–ª–∏ —Ä–µ–∞–ª–∏–∑—É–π—Ç–µ –¥—Ä—É–≥—É—é —Å–∏—Å—Ç–µ–º—É –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, JWT –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π).

**Q: –ú–æ–≥—É –ª–∏ —è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ API –∫–ª—é—á–µ–π?**
A: –í —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –∫–ª—é—á. –î–ª—è –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∫–ª—é—á–µ–π –Ω—É–∂–Ω–æ —Ä–∞—Å—à–∏—Ä–∏—Ç—å middleware.

**Q: –ß—Ç–æ –¥–µ–ª–∞—Ç—å, –µ—Å–ª–∏ –∫–ª—é—á —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω?**
A: –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –Ω–æ–≤—ã–π –∫–ª—é—á, –æ–±–Ω–æ–≤–∏—Ç–µ `.env` –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.
